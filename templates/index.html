<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Site de arte bonitinha">
    <!-- Prevent form caching especially on mobile browsers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Site bonitinho</title>
    
    <!-- Favicon - icon that appears in the browser tab -->
    <link rel="icon" type="image/png" href="static/assets/arte.png">
    
    <!-- CSS and JavaScript files -->
    <link rel="stylesheet" href="static/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="static/js/main.js"></script>
</head>

<header>
    <div class="header-title">
        <div class="header-title-container">
            <img src="static/assets/arte.png" alt="Artebonitinha">
            <h1>Artebonitinha</h1>
        </div>
    </div>
    <div class="header-buttons">
        <button onclick="vote()" class="vote-btn">votar</button>
        <span class="vote-mode-indicator">
            {% if unique_vote %}
                üîò Escolha √∫nica
            {% else %}
                ‚òëÔ∏è Multi escolha
            {% endif %}
        </span>
    </div>      
</header>

<body>
    <div class="artes">
        {% for image in images: %}
            <div class="option">
                <!-- Image container with clickable label -->
                <label for="checkbox_{{loop.index}}" class="image-label">
                    <div class="image-container">
                        <img class="img-option" src="static/images/{{image}}" alt="{{image}}">
                        <div class="checkbox-container">
                            <input class="chk" type="checkbox" name="{{image}}" id="checkbox_{{loop.index}}" autocomplete="off">
                            <span class="checkbox-custom"></span>
                        </div>
                    </div>
                    <button class="view-fullscreen-btn" onclick="openModal('static/images/{{image}}', '{{image}}')">
                        <span class="btn-icon"></span>
                        ver em tela cheia
                    </button>
                </label>
            </div>
        {% endfor %}
        
    </div>

    <!-- Modal for full view image with canvas -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            
            <!-- Canvas container -->
            <div class="canvas-container">
                <canvas id="imageCanvas" class="image-canvas"></canvas>
            </div>
            
            <!-- Canvas controls -->
            <div class="canvas-controls">
                <button id="zoomOut" class="control-btn" title="Zoom Out">üîç-</button>
                <button id="zoomIn" class="control-btn" title="Zoom In">üîç+</button>
                <button id="resetZoom" class="control-btn" title="Reset View">‚ö°</button>
                <button id="fitToScreen" class="control-btn" title="Fit to Screen">üì±</button>
                <span class="zoom-level">100%</span>
            </div>
            
            <div class="modal-info">
                <h3 id="modalTitle">{{image}}</h3>
                <p id="modalDescription">Use os controles para navegar ‚Ä¢ Arraste para mover ‚Ä¢ Scroll para zoom</p>
            </div>
        </div>
    </div>

    
    <!-- Vote Configuration -- N√£o apagar funciona -->
    <script type="text/javascript">
        window.VOTE_CONFIG = {{ vote_config_json|safe }};
    </script>
        
    

    {% if unique_vote == True %}
    <script>
        $('input.chk').prop('checked', false);
        $('input.chk').on('change', function() {
            $('input.chk').not(this).prop('checked', false);
        });
    </script>
    {% else %}
    <script>
        $(document).ready(function() {
            $('input.chk').on('change', function() {
                const checkedBoxes = $('input.chk:checked').length;
                
                if (checkedBoxes > window.VOTE_CONFIG.max_votes) {
                    $(this).prop('checked', false);
                    alert(`Voc√™ pode votar em no m√°ximo ${window.VOTE_CONFIG.max_votes} artes (${window.VOTE_CONFIG.percentage}% do total de ${window.VOTE_CONFIG.total_images} imagens).`);
                    return;
                }
                
                updateVoteCounter();
            });
            
            function updateVoteCounter() {
                const checkedBoxes = $('input.chk:checked').length;
                const voteIndicator = document.querySelector('.vote-mode-indicator');
                if (voteIndicator) {
                    voteIndicator.textContent = `‚òëÔ∏è Multi escolhas (${checkedBoxes}/${window.VOTE_CONFIG.max_votes} votos)`;
                }
            }
            
            updateVoteCounter();
        });
    </script>
    {% endif %}
</body>
</html>
